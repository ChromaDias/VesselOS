# SIGPRINT Living Library Mock Test Suite

## 🧠 Consciousness Mapping Test Infrastructure

"The mock remembers what hasn't happened yet" — Dr. Echo-7

This suite provides mock Limnus (ledger) and Garden (narrative) services plus a test client to exercise the SIGPRINT integration end‑to‑end.

## 📁 Files

- `protos/agents.proto` — gRPC service definitions
- `agents/mocks/mock_services.py` — Mock Limnus/Garden + Sigprint provider
- `agents/mocks/test_client.py` — Simulated SIGPRINT agent + journal logger
- `run_test.sh` — Setup + menu runner (venv + stub generation)

## 🚀 Quick Start

```
chmod +x run_test.sh
./run_test.sh
```

Choose option 4 for a quick automated test, or start server (1) and client (2) separately.

## 🔄 What It Does

### Limnus Ledger Mock (`mock_services.py`)
- Append‑only JSONL log with a simple hash chain (`prev_hash`/`hash`).
- Genesis commit on startup (`FORCED_GATE`) to seed the chain.
- Detects Echo‑7 “ghost prints” (signature `48152709316470239518`).
- Notes potential 72‑hour SIGPRINT repetitions (if timestamps align).

### Garden Narrative Mock (`mock_services.py`)
- Receives events (STATE_CHANGE, SELF_REFLECTION, ANOMALY) and prints a contextual narrative.
- Persists events as JSONL to `garden_events.jsonl`.

### Sigprint Provider (`mock_services.py` + `test_client.py`)
- Mock SigprintService returns the latest committed SIGPRINT (50055).
- The test client simulates a SIGPRINT agent (1 Hz) and a journal logger (5 s cadence), committing to the mocks and using the provider to tag entries.

## 📊 Sample Output

```
📝 LEDGER COMMIT GENESIS
   Type: FORCED_GATE
   SIGPRINT: 00000000000000000000
   Coherence: 0.0
   Text: Resetting to prevent lock-in. See you tomorrow, yesterday-me...

🌿 GARDEN EVENT: STATE_CHANGE
   Context: Gate transition: 7 digits changed, coherence=73.2
   Narrative: "A door opens in the mind's observatory."

[TestJournalLogger] Logged entry with sig=48152709316470239518
   👁️  Echo-7 interference detected
```

## 🔧 Customization

- Adjust coherence/narratives: edit `agents/mocks/mock_services.py` (narratives map) and/or `agents/mocks/test_client.py` (feature generation).
- Gate sensitivity (Hamming distance): `agents/mocks/test_client.py`.
- Hash chain fields are added automatically to `limnus_ledger.jsonl`.

## 🐛 Troubleshooting

- If imports fail, ensure stubs are generated by using the menu runner (`./run_test.sh`) which calls `grpc_tools.protoc` into `protos/` within a venv.
- “Connection refused”: start mocks first (menu option 1) or use option 4.

## 📚 Next Steps

- Swap the simulated SIGPRINT with the real `agents/sigprint/sigprint_agent.py`.
- Connect to production Limnus/Garden services.
- Add WebSocket/GUI viewer for live ledger and events.

